<div class="tab-pane fade show active" id="aps-tab-pane" role="tabpanel" aria-labelledby="aps-tab" tabindex="0">
    <!-- APS Tab content begins here -->
    <h2>Algorithm Performance Space</h2>
    <p>
        <strong>Algorithm Performance Space (APS)</strong> is a tool to help you pick better, more diverse datasets for testing your
        recommender systems algorithms. Instead of selecting popular datasets blindly, APS maps datasets based on how different algorithms
        perform on them. By using this tool:
        <ul style="list-style: none; padding-left: 1rem;">
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can identify datasets where algorithms struggle.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can avoid spending much time on datasets where all algorithms already do well.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can see which datasets are very similar and might not add much new information for training and benchmarking.</span>
            </li>
        </ul>
        The graph below visualizes this by reducing the performance results of datasets into two dimensions using
        <strong>Principal Component Analysis (PCA)</strong> based on the select performance metric such as nDCG, Hit Ratio (HR) or Recall
        and the selected K-value.
        <br style="margin-bottom: 1rem;">
        <strong>Difficulties:</strong> The difficulty levels of datasets are defined based on their positions on the graph, where each point
        represents a dataset. The PCA's axes are not normalized but are scaled according to the variance captured in the selected datasets,
        due to the variance-preserving nature of PCA. To determine the difficulty levels of the selected datasets, the minimum values
        along the X and Y axes are computed independently across all datasets. This minima defines a reference point corresponding to
        the highest difficulty. Each dataset's position is then evaluated relative to this reference, which makes the difficulty levels
        inherently relative to the selected datasets. This is because the range and distribution of the PCA graph change depending on
        the overall dataset composition, which influences how difficult a dataset appears in comparison to others.
        <br style="margin-bottom: 1rem;">
        <strong>Similarities:</strong> Dataset similarity is calculated not only by their <strong>Euclidean distances</strong> in PCA space
        but also by the uncertainty in their positions, which is visualized by ellipses around each point. These ellipses represent
        the variance of each dataset along the X and Y axes. Given the uncertainty in dataset positions, a variance-normalized distance metric,
        which is similar to the <strong>Mahalanobis distance</strong>, is used to find the similarities. This approach measures how close
        two datasets are relative to their combined positional uncertainty.
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <msup>
                <mi>distance</mi>
                <mn>2</mn>
            </msup>
            <mo>=</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varX</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varX</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
            <mo>+</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varY</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varY</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
        </math>
        A smaller distance indicates greater similarity between two datasets, while taking their relative uncertainty along each axis into
        account. A confidence score is then calculated by applying an <strong>exponential transformation</strong> to this distance,
        which maps smaller distances to higher confidence values:
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <mi>confidence</mi>
            <mo>=</mo>
            <msup>
                <mi>e</mi>
                <mrow>
                    <mo>-</mo>
                    <mi>distance</mi>
                </mrow>
            </msup>
        </math>
        Higher confidence represents stronger similarity in algorithm performance between the datasets.
    </p>

    <hr>

    <!-- Form controls to select performance metric an k value for the PCA -->
    <div class="row mb-3">
        <div class="col">
            <label for="formPerformanceMetricPca" class="form-label">Performance Metric</label>
            <select id="formPerformanceMetricPca" class="form-select updatePca" aria-label="Select performance metric">
                <option value="ndcg">nDCG</option>
                <option value="hr">Hit Ratio (HR)</option>
                <option value="recall">Recall</option>
            </select>
        </div>
        <div class="col">
            <label for="formKValuePca" class="form-label">K-Value</label>
            <select id="formKValuePca" class="form-select updatePca" aria-label="Select k-value">
                <option value="one">@1</option>
                <option value="three">@3</option>
                <option value="five">@5</option>
                <option value="ten">@10</option>
                <option value="twenty">@20</option>
            </select>
        </div>
    </div>

    <div class="accordion" id="accordionAPSAlgo" style="margin-bottom: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                    data-bs-target="#apsAlgoNames" aria-expanded="false" aria-controls="apsAlgoNames">
                    Algorithms
                </button>
            </h2>
            <div id="apsAlgoNames" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPSAlgo">
                <div id="aps-algo" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Algorithm names -->
                </div>
            </div>
        </div>
    </div>

    <div class="accordion" id="accordionAPS">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                    <span>Dataset Filter</span>
                    <span id="aps-filter-header" style="margin-left: auto;">(All selected)</span>
                </button>
            </h2>
            <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPS">
                <div id="aps-filter" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Dataset filter checkboxes -->
                </div>
            </div>
        </div>
    </div>

    <canvas id="aps-chart" class="my-3" style="touch-action: none; user-select: none;"></canvas>
    <div style="display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 1rem;">
        <button id="aps-reset-graph-btn" type="button" class="btn btn-primary">Reset Graph</button>
        <button id="aps-export-png-btn" type="button" class="btn btn-primary">Export as PNG</button>
    </div>

    <hr style="margin-bottom: 1.5rem;">

    <div class="accordion" id="aps-dataset-difficulties-container">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-difficulties" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    Difficulties
                </button>
            </h2>
            <div id="aps-dataset-difficulties" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPS">
                <div id="aps-dataset-difficulties-body" class="accordion-body"
                    style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold;">Difficulty Levels:</h5>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                            <span class="badge bg-dark">Very Hard (&lt;= 0.2)</span>
                            <span class="badge bg-danger">Hard (0.2 - 0.3)</span>
                            <span class="badge bg-warning text-dark">Medium (0.3 - 0.4)</span>
                            <span class="badge bg-primary">Easy (0.4 - 0.7)</span>
                            <span class="badge bg-success">Very Easy (&gt;= 0.7)</span>
                        </div>
                    </div>
                    <div id="dataset-difficulty" style="margin-top: 2rem;">
                        <!-- Dataset Difficulties -->
                        <div><strong>Dataset D</strong></div>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-danger" role="progressbar" style="width: 85%;" aria-valuenow="85"
                                aria-valuemin="0" aria-valuemax="100">Hard</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion" id="aps-dataset-similarities-container" style="margin-top: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-similarities" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    Similarities
                </button>
            </h2>
            <div id="aps-dataset-similarities" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPS">
                <div id="aps-dataset-similarities-body" class="accordion-body" style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold;">Similarity Confidence Levels:</h5>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                            <span class="badge bg-secondary">Very Low (&lt;= 0.25)</span>
                            <span class="badge bg-danger">Low (0.25 - 0.5)</span>
                            <span class="badge bg-warning text-dark">Moderate (0.5 - 0.75)</span>
                            <span class="badge bg-primary">High (0.75 - 0.9)</span>
                            <span class="badge bg-success">Very High (&gt;= 0.9)</span>
                        </div>
                    </div>
                    <div id="similar-datasets" style="margin-top: 2rem;">
                        <!-- Similar Datasets -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>