<div class="tab-pane fade show active" id="aps-tab-pane" role="tabpanel" aria-labelledby="aps-tab" tabindex="0">
    <!-- APS Tab content begins here -->
    <h2>Algorithm Performance Space</h2>
    <p>
        <strong>Algorithm Performance Space (APS)</strong> is a tool to help you pick better, more diverse datasets for testing your
        recommender systems algorithms. Instead of selecting popular datasets blindly, APS maps datasets based on how different algorithms
        perform on them. By using this tool:
        <ul style="list-style: none; padding-left: 1rem;">
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can identify datasets where algorithms struggle.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can avoid spending much time on datasets where all algorithms already do well.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can see which datasets are very similar and might not add much new information for training and benchmarking.</span>
            </li>
        </ul>
        The graph below visualizes this by reducing the performance results of datasets into two dimensions using
        <strong>Principal Component Analysis (PCA)</strong> based on the select performance metric such as nDCG, Hit Ratio (HR)
        or Recall and the selected K-value. The graph axes, <strong>Component 1</strong> and <strong>Component 2</strong>, represent
        new composite variables that capture the most significant patterns in the original performance results. Specifically,
        Component 1 explains the largest portion of the variance that reflects the dominant trend across datasets, whereas Component 2
        accounts for the second-largest variance that highlights additional, independent patterns. These components are linear combinations
        of the original results and allow us to visualize and compare complex multi-dimensional results in a simplified two-dimensional space.
        As a result, the position of each dataset on the plot indicates its overall performance profile relative to others
        based on the selected metrics and K-values.
        <br style="margin-bottom: 1rem;">
        <strong>Difficulties:</strong> The difficulty levels of datasets are inferred from their positions on the graph, where each point
        corresponds to a dataset. Because PCA preserves variance, the axes reflect the amount of variability captured among all datasets.
        To establish difficulty levels, the minimum values along the X and Y axes are identified independently across all datasets, which
        defines a reference point that represents the highest difficulty. Each dataset's position is then assessed relative to this reference,
        making the difficulty levels inherently relative to the overall performance of all algorithms on all datasets. This relativity arises
        because the range and distribution of points on the PCA graph depend on the combined characteristics of all datasets, which affects
        how difficult a dataset appears in comparison to others.
        <br style="margin-bottom: 1rem;">
        <strong>Similarities:</strong> Dataset similarity is assessed not only by their Euclidean distances on the PCA graph but also
        by the uncertainty in their positions, which is shown as ellipses surrounding each point. These ellipses represent the variance of
        each dataset along the X and Y axes. To account for this positional uncertainty, a variance-normalized distance metric is employed.
        This method evaluates the closeness of two datasets relative to their combined uncertainty. This provides a more robust measure of
        similarity than simple Euclidean distance alone.
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <msup>
                <mi>distance</mi>
                <mn>2</mn>
            </msup>
            <mo>=</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varX</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varX</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
            <mo>+</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varY</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varY</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
        </math>
        A smaller distance indicates a higher similarity between two datasets, while accounting for their relative uncertainty
        along each axis. To quantify this, a confidence score is computed by applying an <strong>exponential decay</strong>
        to the distance, which converts smaller distances into higher confidence values:
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <mi>confidence</mi>
            <mo>=</mo>
            <msup>
                <mi>e</mi>
                <mrow>
                    <mo>-</mo>
                    <mi>distance</mi>
                </mrow>
            </msup>
        </math>
    </p>

    <hr>

    <!-- Form controls to select performance metric an k value for the PCA -->
    <div class="row mb-3">
        <div class="col">
            <label for="formPerformanceMetricPca" class="form-label">Performance Metric</label>
            <select id="formPerformanceMetricPca" class="form-select aps-selection" aria-label="Select performance metric">
                <option value="ndcg">nDCG</option>
                <option value="hr">Hit Ratio (HR)</option>
                <option value="recall">Recall</option>
            </select>
        </div>
        <div class="col">
            <label for="formKValuePca" class="form-label">K-Value</label>
            <select id="formKValuePca" class="form-select aps-selection" aria-label="Select k-value">
                <option value="one">@1</option>
                <option value="three">@3</option>
                <option value="five">@5</option>
                <option value="ten">@10</option>
                <option value="twenty">@20</option>
            </select>
        </div>
    </div>

    <div class="accordion" id="accordionAPS-algo" style="margin-bottom: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-algo">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#algorithmFilter" aria-expanded="false" aria-controls="algorithmFilter">
                    <span>Algorithm Filter</span>
                    <span id="aps-algorithm-filter-header" style="margin-left: auto;">(All selected)</span>
                </button>
            </h2>
            <div id="algorithmFilter" class="accordion-collapse collapse" aria-labelledby="headingOne-algo"
                data-bs-parent="#accordionAPS-algo">
                <div id="aps-algorithm-filter" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Algorithm filter checkboxes -->
                </div>
            </div>
        </div>
    </div>

    <div class="accordion" id="accordionAPS">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#datasetFilter" aria-expanded="false" aria-controls="datasetFilter">
                    <span>Dataset Filter</span>
                    <span id="aps-dataset-filter-header" style="margin-left: auto;">(All selected)</span>
                </button>
            </h2>
            <div id="datasetFilter" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPS">
                <div id="aps-dataset-filter" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Dataset filter checkboxes -->
                </div>
            </div>
        </div>
    </div>

    <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; margin-top: 1rem;">
        <button id="aps-update-pca-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-arrows-rotate" style="color: white !important; margin-right: 0.3rem;"></i>Update PCA
        </button>
        <span id="aps-update-pca-txt-none-selected" style="display: none; font-weight: 400; font-style: italic;">At least two algorithms and two datasets must be selected!</span>
        <span id="aps-update-pca-txt-stale" style="display: none; font-weight: 400; font-style: italic;">The data on the graph is now stale!</span>
        <span id="aps-update-pca-txt-calculating" class="fading-text" style="display: none; font-weight: 400; font-style: italic;">Calculating...</span>
    </div>

    <canvas id="aps-chart" class="my-3" style="touch-action: none; user-select: none;"></canvas>
    <div style="display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 1rem;">
        <button id="aps-reset-graph-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-rotate-right" style="color: white !important; margin-right: 0.3rem;"></i>Refresh View
        </button>
        <button id="aps-export-png-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-download" style="color: white !important; margin-right: 0.3rem;"></i>Export as PNG
        </button>
    </div>

    <hr style="margin-bottom: 1.5rem;">

    <div class="accordion" id="aps-dataset-difficulties-container">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-diff">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-difficulties" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    Difficulties
                </button>
            </h2>
            <div id="aps-dataset-difficulties" class="accordion-collapse collapse" aria-labelledby="headingOne-diff"
                data-bs-parent="#accordionAPS-diff">
                <div id="aps-dataset-difficulties-body" class="accordion-body"
                    style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold;">Difficulty Levels:</h5>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                            <span class="badge bg-dark">Very Hard (&lt;= 0.2)</span>
                            <span class="badge bg-danger">Hard (0.2 - 0.3)</span>
                            <span class="badge bg-warning text-dark">Medium (0.3 - 0.4)</span>
                            <span class="badge bg-primary">Easy (0.4 - 0.7)</span>
                            <span class="badge bg-success">Very Easy (&gt;= 0.7)</span>
                        </div>
                    </div>
                    <div id="dataset-difficulty" style="margin-top: 2rem;">
                        <!-- Dataset Difficulties -->
                        <div><strong>Dataset D</strong></div>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-danger" role="progressbar" style="width: 85%;" aria-valuenow="85"
                                aria-valuemin="0" aria-valuemax="100">Hard</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="accordion" id="aps-dataset-similarities-container" style="margin-top: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-sim">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-similarities" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    Similarities
                </button>
            </h2>
            <div id="aps-dataset-similarities" class="accordion-collapse collapse" aria-labelledby="headingOne-sim"
                data-bs-parent="#accordionAPS-sim">
                <div id="aps-dataset-similarities-body" class="accordion-body" style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold;">Similarity Confidence Levels:</h5>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                            <span class="badge bg-secondary">Very Low (&lt;= 0.25)</span>
                            <span class="badge bg-danger">Low (0.25 - 0.5)</span>
                            <span class="badge bg-warning text-dark">Moderate (0.5 - 0.75)</span>
                            <span class="badge bg-primary">High (0.75 - 0.9)</span>
                            <span class="badge bg-success">Very High (&gt;= 0.9)</span>
                        </div>
                    </div>
                    <div id="similar-datasets" style="margin-top: 2rem;">
                        <!-- Similar Datasets -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>