<div class="tab-pane fade show active" id="aps-tab-pane" role="tabpanel" aria-labelledby="aps-tab" tabindex="0">
    <!-- APS Tab content begins here -->
    <h2>Algorithm Performance Space</h2>
    <p>
        <strong>Algorithm Performance Space (APS)</strong> is a tool to help you pick better, more diverse datasets for testing your
        recommender systems algorithms. Instead of selecting popular datasets blindly, APS maps datasets based on how different algorithms
        perform on them. By using this tool:
        <ul style="list-style: none; padding-left: 1rem;">
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can identify datasets where algorithms struggle.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can avoid spending much time on datasets where all algorithms already do well.</span>
            </li>
            <li style="display: flex; align-items: center; position: relative; padding-left: 1rem; margin-bottom: 0.5rem;">
                <span style="position: absolute; left: 0; width: 12px; height: 12px; background-color: #8d8d8d; border-radius: 50%;"></span>
                <span style="margin-left: 0.5rem;">You can see which datasets are very similar and might not add much new information for training and benchmarking.</span>
            </li>
        </ul>
        The graph below visualizes this by reducing the performance results of datasets into two dimensions using
        <strong>Principal Component Analysis (PCA)</strong> based on the select performance metric such as nDCG, Hit Ratio (HR)
        or Recall and the selected K-value. The graph axes, <strong>Component 1</strong> and <strong>Component 2</strong>, represent
        new composite variables that capture the most significant patterns in the original performance results. Specifically,
        Component 1 explains the largest portion of the variance that reflects the dominant trend across datasets, whereas Component 2
        accounts for the second-largest variance that highlights additional, independent patterns. These components are linear combinations
        of the original results and allow us to visualize and compare complex multi-dimensional results in a simplified two-dimensional space.
        As a result, the position of each dataset on the plot indicates its overall performance profile relative to others
        based on the selected metrics and K-values.
        <br style="margin-bottom: 1rem;">
        <strong>Difficulties:</strong> The difficulty levels of datasets are inferred from their positions on the graph, where each point
        corresponds to a dataset. Because PCA preserves variance, the axes reflect the amount of variability captured among all datasets.
        To establish difficulty levels, the minimum values along the X and Y axes are identified independently across all datasets, which
        defines a reference point that represents the highest difficulty. Each dataset's position is then assessed relative to this reference,
        making the difficulty levels inherently relative to the overall performance of all algorithms on all datasets. This relativity arises
        because the range and distribution of points on the PCA graph depend on the combined characteristics of all datasets, which affects
        how difficult a dataset appears in comparison to others.
        <br style="margin-bottom: 1rem;">
        <strong>Similarities:</strong> Dataset similarity is assessed not only by their Euclidean distances on the PCA graph but also
        by the uncertainty in their positions, which is shown as ellipses surrounding each point. These ellipses represent the variance of
        each dataset along the X and Y axes. To account for this positional uncertainty, a variance-normalized distance metric is employed.
        This method evaluates the closeness of two datasets relative to their combined uncertainty. This provides a more robust measure of
        similarity than simple Euclidean distance alone.
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <msup>
                <mi>distance</mi>
                <mn>2</mn>
            </msup>
            <mo>=</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>x</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varX</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varX</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
            <mo>+</mo>
            <mfrac>
                <msup>
                    <mrow>
                        <mo>(</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>2</mn>
                        </msub>
                        <mo>-</mo>
                        <msub>
                            <mi>y</mi>
                            <mn>1</mn>
                        </msub>
                        <mo>)</mo>
                    </mrow>
                    <mn>2</mn>
                </msup>
                <mrow>
                    <msub>
                        <mi>varY</mi>
                        <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                        <mi>varY</mi>
                        <mn>2</mn>
                    </msub>
                </mrow>
            </mfrac>
        </math>
        A smaller distance indicates a higher similarity between two datasets, while accounting for their relative uncertainty
        along each axis. To quantify this, a confidence score is computed by applying an <strong>exponential decay</strong>
        to the distance, which converts smaller distances into higher confidence values:
        <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="margin-top: 1rem; margin-bottom: 1rem;">
            <mi>confidence</mi>
            <mo>=</mo>
            <msup>
                <mi>e</mi>
                <mrow>
                    <mo>-</mo>
                    <mi>distance</mi>
                </mrow>
            </msup>
        </math>
    </p>

    <hr>

    <!-- Form controls to select performance metric an k value for the PCA -->
    <div class="row mb-3">
        <div class="col">
            <label for="formPerformanceMetricPca" class="form-label">Performance Metric</label>
            <select id="formPerformanceMetricPca" class="form-select aps-selection" aria-label="Select performance metric">
                <option value="ndcg">nDCG</option>
                <option value="hr">Hit Ratio (HR)</option>
                <option value="recall">Recall</option>
            </select>
        </div>
        <div class="col">
            <label for="formKValuePca" class="form-label">K-Value</label>
            <select id="formKValuePca" class="form-select aps-selection" aria-label="Select k-value">
                <option value="one">@1</option>
                <option value="three">@3</option>
                <option value="five">@5</option>
                <option value="ten">@10</option>
                <option value="twenty">@20</option>
            </select>
        </div>
    </div>

    <div class="accordion" id="accordionAPS-algo" style="margin-bottom: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-algo">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#algorithmFilter" aria-expanded="false" aria-controls="algorithmFilter">
                    <span>Algorithm Filter</span>
                    <span id="aps-algorithm-filter-header" style="margin-left: auto;">(All selected)</span>
                </button>
            </h2>
            <div id="algorithmFilter" class="accordion-collapse collapse" aria-labelledby="headingOne-algo"
                data-bs-parent="#accordionAPS-algo">
                <div id="aps-algorithm-filter" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Algorithm filter checkboxes -->
                </div>
            </div>
        </div>
    </div>

    <div class="accordion" id="accordionAPS">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#datasetFilter" aria-expanded="false" aria-controls="datasetFilter">
                    <span>Dataset Filter</span>
                    <span id="aps-dataset-filter-header" style="margin-left: auto;">(All selected)</span>
                </button>
            </h2>
            <div id="datasetFilter" class="accordion-collapse collapse" aria-labelledby="headingOne"
                data-bs-parent="#accordionAPS">
                <div id="aps-dataset-filter" class="accordion-body" style="display: flex; flex-wrap: wrap; gap: 12px;">
                    <!-- Dataset filter checkboxes -->
                </div>
            </div>
        </div>
    </div>

    <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; margin-top: 1rem;">
        <button id="aps-update-pca-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-arrows-rotate" style="color: white !important; margin-right: 0.3rem;"></i>Update PCA
        </button>
        <span id="aps-update-pca-txt-none-selected" style="display: none; font-weight: 400; font-style: italic;">At least two algorithms and two datasets must be selected!</span>
        <span id="aps-update-pca-txt-stale" style="display: none; font-weight: 400; font-style: italic;">The data on the graph is now stale!</span>
        <span id="aps-update-pca-txt-calculating" class="fading-text" style="display: none; font-weight: 400; font-style: italic;">Calculating...</span>
    </div>

    <canvas id="aps-chart" class="my-3" style="touch-action: none; user-select: none;"></canvas>
    <div style="display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 1rem;">
        <button id="aps-reset-graph-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-rotate-right" style="color: white !important; margin-right: 0.3rem;"></i>Refresh View
        </button>
        <button id="aps-export-png-btn" type="button" class="btn btn-primary">
            <i class="fa-solid fa-download" style="color: white !important; margin-right: 0.3rem;"></i>Export as PNG
        </button>
    </div>

    <hr style="margin-bottom: 1.5rem;">

    <!-- DIFFICULTIES SECTION WITH MODAL INFO ICON -->
    <div class="accordion" id="aps-dataset-difficulties-container">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-diff">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-difficulties" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    <span>Dataset Difficulties</span>
                </button>
            </h2>
            <div id="aps-dataset-difficulties" class="accordion-collapse collapse" aria-labelledby="headingOne-diff"
                data-bs-parent="#accordionAPS-diff">
                <div id="aps-dataset-difficulties-body" class="accordion-body"
                    style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold; display: flex; flex-direction: row; align-content: center;">Difficulty Levels
                            <span id="difficulties-info-icon" class="info-icon-modal" style="padding-top: 0.17rem;">&#8505;</span>
                        </h5>
                    </div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                        <span class="badge bg-dark">Very Hard (&lt;= 0.2)</span>
                        <span class="badge bg-danger">Hard (0.2 - 0.3)</span>
                        <span class="badge bg-warning text-dark">Medium (0.3 - 0.4)</span>
                        <span class="badge bg-primary">Easy (0.4 - 0.7)</span>
                        <span class="badge bg-success">Very Easy (&gt;= 0.7)</span>
                    </div>
                    <div id="dataset-difficulty" style="margin-top: 2rem;">
                        <!-- Dataset Difficulties -->
                        <div><strong>Dataset D</strong></div>
                        <div class="progress" style="height: 20px;">
                            <div class="progress-bar bg-danger" role="progressbar" style="width: 85%;" aria-valuenow="85"
                                aria-valuemin="0" aria-valuemax="100">Hard</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SIMILARITIES SECTION WITH MODAL INFO ICON -->
    <div class="accordion" id="aps-dataset-similarities-container" style="margin-top: 1rem;">
        <div class="accordion-item">
            <h2 class="accordion-header" id="headingOne-sim">
                <button class="accordion-button collapsed acc-btn-icon" type="button" data-bs-toggle="collapse"
                    data-bs-target="#aps-dataset-similarities" aria-expanded="false" aria-controls="collapseOne"
                    style="display: flex; justify-content: space-between; width: 100%;">
                    <span>Dataset Similarities</span>
                </button>
            </h2>
            <div id="aps-dataset-similarities" class="accordion-collapse collapse" aria-labelledby="headingOne-sim"
                data-bs-parent="#accordionAPS-sim">
                <div id="aps-dataset-similarities-body" class="accordion-body" style="display: flex; flex-direction: column;">
                    <div>
                        <h5 style="font-weight: bold; display: flex; flex-direction: row; align-content: center;">Similarity Confidence Levels
                            <span id="similarities-info-icon" class="info-icon-modal" style="padding-top: 0.17rem;">&#8505;</span>
                        </h5>
                    </div>
                    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-top: 0.5rem;">
                        <span class="badge bg-secondary">Very Low (&lt;= 0.25)</span>
                        <span class="badge bg-danger">Low (0.25 - 0.5)</span>
                        <span class="badge bg-warning text-dark">Moderate (0.5 - 0.75)</span>
                        <span class="badge bg-primary">High (0.75 - 0.9)</span>
                        <span class="badge bg-success">Very High (&gt;= 0.9)</span>
                    </div>
                    <div id="similar-datasets" style="margin-top: 2rem;">
                        <!-- Similar Datasets -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DIFFICULTIES MODAL -->
    <div id="difficulties-modal" class="info-modal-overlay">
        <div class="info-modal-content">
            <div class="info-modal-header">
                <h2 class="info-modal-title">Difficulty Levels</h2>
                <button class="info-modal-close" type="button">&times;</button>
            </div>
            <div class="info-modal-body">
                <div class="info-modal-section">
                    <div class="info-modal-level">
                        <div class="info-modal-badge very-hard">Very Hard</div>
                        <div class="info-modal-info">
                            <h4>0.00 - 0.20</h4>
                            <p>In PCA-based APS, lower scores mean worse algorithm performance. The research paper identifies datasets near the origin as “unsolved problems.” 0–0.2 captures this extreme difficulty.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge hard">Hard</div>
                        <div class="info-modal-info">
                            <h4>0.20 - 0.30</h4>
                            <p>This range captures a <strong>transition zone</strong> — separating total failure (&lt;0.2) from early-stage success. These values still represent low overall performance.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge medium">Medium</div>
                        <div class="info-modal-info">
                            <h4>0.30 - 0.40</h4>
                            <p>Around this range, datasets begin to <strong>diversify</strong>. It's a middle band between failure and success, as also reflected in PCA clusters in the APS visualization.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge easy">Easy</div>
                        <div class="info-modal-info">
                            <h4>0.40 - 0.70</h4>
                            <p>Scores above 0.4 indicate datasets where <strong>multiple algorithms</strong> succeed. The upper limit (0.7) stops before the "solved" zone mentioned in the research paper.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge very-easy">Very Easy</div>
                        <div class="info-modal-info">
                            <h4>0.70 - 1.00</h4>
                            <p>The research paper describes top-right datasets as “solved” — where nearly all algorithms do well. These are at or near <strong>maximum PCA scores</strong>, normalized to 1.0.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SIMILARITIES MODAL -->
    <div id="similarities-modal" class="info-modal-overlay">
        <div class="info-modal-content">
            <div class="info-modal-header">
                <h2 class="info-modal-title">Similarity Confidence Levels</h2>
                <button class="info-modal-close" type="button">&times;</button>
            </div>
            <div class="info-modal-body">
                <div class="info-modal-section">
                    <div class="info-modal-level">
                        <div class="info-modal-badge very-low">Very Low</div>
                        <div class="info-modal-info">
                            <h4>0.00 - 0.25</h4>
                            <p>Datasets are highly different; algorithm behavior is inconsistent, and uncertainty is high. This corresponds to <strong>distance > 1.4</strong>. After applying <code>confidence = e^(-distance)</code>, values fall below 0.25.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge low">Low</div>
                        <div class="info-modal-info">
                            <h4>0.25 - 0.50</h4>
                            <p>Datasets have weak similarity. Some patterns may match, but results are not reliable. From <code>e^(-1.0) ≈ 0.37</code>, we know this captures <strong>distance ~0.7-1.4</strong> — medium-long range.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge moderate">Moderate</div>
                        <div class="info-modal-info">
                            <h4>0.50 - 0.75</h4>
                            <p>Some similarity in algorithm performance; useful but not close enough to assume equivalence. <code>e^(-0.7) ≈ 0.5</code>, <code>e^(-0.3) ≈ 0.74</code> — this captures <strong>distance ~0.3-0.7</strong> and shows noticeable, but not strong, similarity.</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge high">High</div>
                        <div class="info-modal-info">
                            <h4>0.75 - 0.90</h4>
                            <p>Strong overlap in performance; datasets behave similarly in most cases. Very small distances: <code>e^(-0.25 to -0.1)</code> gives high confidence (around 0.78-0.9).</p>
                        </div>
                    </div>
                    
                    <div class="info-modal-level">
                        <div class="info-modal-badge very-high">Very High</div>
                        <div class="info-modal-info">
                            <h4>0.90 - 1.00</h4>
                            <p>Datasets are nearly identical in how algorithms perform on them. <code>distance ≈ 0</code>, so <code>confidence = e^0 = 1</code>. Any distance < ~0.1 gives <code>confidence > 0.9</code>, indicating redundancy.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>